# PicoCTF 2022

```bash
Name: basic-file-exploit
Category: Binary Exploitation
Points: 100
```

## Summary

- The `program-redacted.c` does not check for inputs with type `string` and that leads for the program to crash (*when ran locally*) and also leaks the flag for us.

- The code at `data_read()` function only checks for integer (*excluding 0*).

## Code Snippet

```c
    // strtol() = string to long (for more info: see https://man7.org/linux/man-pages/man3/strtol.3.html)
    if ((entry_number = strtol(entry, NULL, 10))==0){
        puts(flag);
        fseek(stdin, 0, SEEK_END);
        exit(0);
    }
```

## Solution

```
1. Input data using option 1.
2. Specfiy the length of your inputted data.
3. Read the inputted data using option 2.
4. When asked for entry number: Type either 0 or any string.
5. Flag should output after that.
```

## Screenshots

![Solution](https://raw.githubusercontent.com/hambyhacks/hambyhacks.github.io/main/Writeups/PicoCTF2022/Binary_Exploitation/basic-file-exploit/img/sol.png)

![Alternate Solution](https://raw.githubusercontent.com/hambyhacks/hambyhacks.github.io/main/Writeups/PicoCTF2022/Binary_Exploitation/basic-file-exploit/img/alt_sol.png)

### Flag

Flag: `picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_E0394EC0}`
